# 1. Preparing the environment

In order to ease the workshop we have created a CloudFormation Stack that deploys the following assets:

- A S3 bucket used for SAM deployments.
- A S3 public web site bucket to host the frontend application.
- A bucket policy for the previous bucket.
- An IAM Role used by **CodeBuild** to access assests generated by SAM, receive and deliver messages from CodePipeline and execute CloudFormation actions.
- An IAM Role used by CloudFormation to deploy all the assets of the application.

## 1.1. Environment CloudFormation.

### 1.1.1: Deploy the Step 0 CloudFormation Stack.

To deploy these assets go to the step0 folder and find the following file:

<img src="../images/0_cloudformation_stack.png" />

Click on one of the following links. Beware! This will be the region you will use during the rest of the workshop!

Region| Code | Launch
------|------|-------
EU (Ireland) | eu-west-1 | [![Launch Step 0 in eu-west-1](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/images/cloudformation-launch-stack-button.png)](https://console.aws.amazon.com/cloudformation/home?region=eu-west-1#/stacks/new?stackName=serverlessops-step0-stack&templateURL=https://s3-eu-west-1.amazonaws.com/serverlessops-functions-eu-west-1/cfn/cf_step0.yml)


1. In the **CloudFormation** Console and click on Next.
2. Verify the Stack name ```serverlessops-step0-stack```, write your **Alias** and click continue. Make sure you enter an **Alias** as it will be used to create your S3 bucket and also ensure that your **Alias** is unique among everyone so chose it wisely.
3. Verify that the **DataPrefix** and the **WsS3BucketBaseName** are filled and click next. 
4. In the next page, leave the default options and click next.
3. Once you are in the final option page, enable CloudFormation to create IAM resources:
	- I acknowledge that AWS CloudFormation might create IAM resources.
	- I acknowledge that AWS CloudFormation might create IAM resources with custom names.
6. Click on **Create Change Set**.
7. Click on **Execute** once you have finished.


## 1.2: Change the buildspec.yaml to add S3 deployments.

The CloudFormation stack will create an S3 bucket for deployments with the following

```
serverlessops-deploymentbucket-<your-alias-here>
```

Now we have to go to `buildspec.yaml`. You will find it in the root folder, of the ZIP you downloaded on previous steps. Change the S3 bucket to the one you have just created. Basically, add the alias you added to the CloudFormation here.


## 1.3 Create a repository in CodeCommit

You will see a landing page with a Get Started button. Click it to start with the creation of the repository.



2. Enter a repository name such as ```ServerlessOps_Repository```
	<img src="../images/codecommit_create_repository.png" width="70%" />
3. Skip Configure email notifications' step.

After doing this, you can skip the connection part of the wizard. We will use it later in the next section.

## Next step

Once you have finished this step you can start the second step [here](../../documentation/2_develop_with_cloud9).
