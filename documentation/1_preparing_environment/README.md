# 1. Preparing the environment
## 1.1. Environment CloudFormation.
## 1.2. Review swagger
## 1.3. Review template.yaml

## Step X: Preparing the field:

### Step X.1: Deploy the Step 0 CloudFormation Stack.

In order to ease the workshop we have created a CloudFormation Stack that deploys the following assets:

- A S3 bucket used for SAM deployments.
- A S3 public web site bucket to host the frontend application.
- A bucket policy for the previous bucket.
- An IAM Role used by **CodeBuild** to access assests generated by SAM, receive and deliver messages from CodePipeline and execute CloudFormation actions.
- An IAM Role used by CloudFormation to deploy all the assets of the application.

To deploy these assets go to the step0 folder and find the follwing file:

<img src="../images/0_cloudformation_stack.png" />

1. Go to the **CloudFormation** Console and click on create a new stack.
2. Select your Alias and click continue.
3. Once you are in the final option page, enable CloudFormation to create IAM resources:

<img src="../images/0_cloudformation_iam_permissions.png" />

### Mayberemoved. Step X.2: Create S3 Bucket for deployments.

Create an S3 bucket where your deployments are going to be uploaded. Use a name such as:

```
serverless-ops-my-deployments-<your-alias-here>
```

Within the code, go to `buildspec.yaml` and change the S3 bucket to the one you have just created.

### Step X.3: Change the Swagger file to add.

Now, the application consists on an API, Lambda and Rekognition to get the tags of a photo. A key element on this application is the API which is defined by a swagger template called **swagger.yaml**.

Go to that file and and change the line 23 which cotains:

```yaml

uri: arn:aws:apigateway:<region>:lambda:path/2015-03-31/functions/arn:aws:lambda:<region>:<AccountID>:function:${stageVariables.LambdaFunctionName}:live/invocations

```

Here you have to change `<region>` and `<AccountId>`with the region you're deploying in and the account Id you are using.

# Add new steps here.
